# 导言
---
首先，进行USART和DMA状态监测、记录异常状态并主动处理，是**高健壮性嵌入式系统开发的核心思想之一。**
这种机制看似复杂，实则能有效保障系统长期、稳定地运行：
- 提升通讯可靠性。
- 降低维护成本。
- 增强系统自恢复能力。

**因此，建议你在STM32项目中实现USART和DMA的健康监测机制。**

另外，STM32串口+DMA通信中引入**超时保护机制的**主要目的是：
- 防止通讯过程中数据不完整或缺失（数据量小于半传输阈值，导致DMA半满、满传输中断均未触发）。可能有人会问？不是有接收空闲中断吗？确实有。但是，有可能接收空闲中断因某些原因导致失效。
- 利用定时器，定期检测DMA接收缓冲区数据变化情况。比如若在一定时间内未收到数据，触发处理或重启DMA。

**因此，引入超时机制（Timeout），可有效提升通信实时性与健壮性。**

# 一、监控串口的异常
---
![[Pasted image 20250312211655.png]]

![[Pasted image 20250312211721.png]]
如上所示，串口的状态寄存器ISR一共有4个错误标志。其中位0的校验错误是在奇偶校验功能开启后才会触发，然而，这个功能一般不会开启。
以上这4个错误的清除方式都是**先读USART_SR再读USART_DR**，跟清除DILE空闲中断标志一样。**所以，有了清除IDLE标志的代码后，不用单独去清除这些错误标志。**









